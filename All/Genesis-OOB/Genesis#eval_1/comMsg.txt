fixing a boundary error with in-place flip
