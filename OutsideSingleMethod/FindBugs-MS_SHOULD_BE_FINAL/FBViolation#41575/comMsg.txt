Finalized some fields, removed redundant code, various other fixes