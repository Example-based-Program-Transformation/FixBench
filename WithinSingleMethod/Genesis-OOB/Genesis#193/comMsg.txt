fixed more problems with index out of bounds exceptions
