Cleaned up logging and fixed warnings. (Log-levels still require tweaking.)